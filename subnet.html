<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>محاسبه Subnet</title>
  <style>
    body { font-family: sans-serif; direction: rtl; padding: 20px; }
    input, button { margin: 5px; padding: 5px; }
    .result { margin-top: 20px; }
  </style>
</head>
<body>
  <h2>محاسبه‌گر Subnet</h2>
  <label>IP آدرس:</label>
  <input type="text" id="ip" value="192.168.2.30"><br>
  <label>Subnet Mask (CIDR):</label>
  <input type="number" id="cidr" value="24" min="1" max="32"><br>
  <button onclick="calculate()">محاسبه کن</button>

  <div class="result" id="output"></div>

  <script>
    function ipToInt(ip) {
      return ip.split('.').reduce((acc, octet) => (acc << 8) + parseInt(octet), 0);
    }

    function intToIp(int) {
      return [(int >>> 24) & 255, (int >>> 16) & 255, (int >>> 8) & 255, int & 255].join('.');
    }

    function calculate() {
      const ip = document.getElementById("ip").value;
      const cidr = parseInt(document.getElementById("cidr").value);
      const ipInt = ipToInt(ip);
      const mask = cidr === 0 ? 0 : (~0 << (32 - cidr)) >>> 0;
      const network = ipInt & mask;
      const broadcast = network | (~mask >>> 0);
      const firstHost = cidr === 32 ? network : network + 1;
      const lastHost = cidr >= 31 ? broadcast : broadcast - 1;
      const hostCount = cidr >= 31 ? 0 : lastHost - firstHost + 1;

      document.getElementById("output").innerHTML = `
        <strong>آدرس شبکه:</strong> ${intToIp(network)}<br>
        <strong>ماسک:</strong> ${intToIp(mask)} /${cidr}<br>
        <strong>Broadcast:</strong> ${intToIp(broadcast)}<br>
        <strong>اولین هاست:</strong> ${intToIp(firstHost)}<br>
        <strong>آخرین هاست:</strong> ${intToIp(lastHost)}<br>
        <strong>تعداد هاست:</strong> ${hostCount}
      `;
    }
  </script>
</body>
</html>
